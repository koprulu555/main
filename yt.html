<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>YouTube M3U8 Player - Alternative</title>
    <style>body { margin: 0; padding: 20px; background: #000; color: white; }</style>
</head>
<body>
    <h1>Alternatif Proxy Denemesi</h1>
    <div id="status">Test ediliyor...</div>
    <div id="result"></div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const videoId = urlParams.get('video_id') || 'MSlOWVOF84o'; // Test için

        const proxies = [
            'https://api.codetabs.com/v1/proxy/?quest=',
            'https://corsproxy.io/?',
            'https://proxy.cors.sh/',
            'https://cors-anywhere.herokuapp.com/',
            'https://crossorigin.me/'
        ];

        async function testProxies() {
            const youtubeUrl = `https://www.youtube.com/watch?v=${videoId}`;
            
            for (const [index, proxy] of proxies.entries()) {
                try {
                    document.getElementById('status').textContent = `Testing proxy ${index + 1}/${proxies.length}: ${proxy}`;
                    
                    const proxyUrl = proxy + encodeURIComponent(youtubeUrl);
                    const response = await fetch(proxyUrl, { 
                        headers: { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36' }
                    });
                    
                    const html = await response.text();
                    const hasM3U8 = html.includes('hlsManifestUrl');
                    
                    const resultDiv = document.getElementById('result');
                    resultDiv.innerHTML += `
                        <div style="margin: 10px; padding: 10px; border: 1px solid ${hasM3U8 ? 'green' : 'red'};">
                            <strong>${proxy}</strong>: ${hasM3U8 ? '✅ M3U8 Bulundu' : '❌ M3U8 Yok'}
                            ${hasM3U8 ? `<br><button onclick="playWithProxy('${proxy}')">Oynat</button>` : ''}
                        </div>
                    `;
                    
                } catch (error) {
                    document.getElementById('result').innerHTML += `
                        <div style="margin: 10px; padding: 10px; border: 1px solid red;">
                            <strong>${proxy}</strong>: ❌ Hata: ${error.message}
                        </div>
                    `;
                }
            }
            
            document.getElementById('status').textContent = 'Test tamamlandı';
        }

        function playWithProxy(proxy) {
            window.location.href = `index.html?video_id=${videoId}&proxy=${encodeURIComponent(proxy)}`;
        }

        testProxies();
    </script>
</body>
</html>
