<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube M3U8 Player</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #1a1a1a; color: white; }
        .container { background: #2d2d2d; padding: 20px; border-radius: 10px; margin: 20px auto; max-width: 800px; }
        input { padding: 10px; width: 300px; border: none; border-radius: 5px; margin-right: 10px; }
        button { padding: 10px 20px; border: none; border-radius: 5px; background: #ff0000; color: white; cursor: pointer; }
        .player { width: 100%; height: 400px; background: #000; margin-top: 20px; border-radius: 10px; }
        .url-display { background: #333; padding: 15px; border-radius: 5px; margin-top: 15px; word-break: break-all; }
    </style>
</head>
<body>
    <div class="container">
        <h1>YouTube M3U8 Player</h1>
        
        <div>
            <input type="text" id="videoId" placeholder="Video ID (√∂rn: MSlOWVOF84o)">
            <button onclick="playFromInput()">Oynat</button>
        </div>

        <div class="player">
            <video id="videoPlayer" controls width="100%" height="100%">
                Tarayƒ±cƒ±nƒ±z video oynatmayƒ± desteklemiyor.
            </video>
        </div>
        
        <div id="urlDisplay" class="url-display"></div>
    </div>

    <script>
        // URL parametrelerini kontrol et
        const urlParams = new URLSearchParams(window.location.search);
        const videoId = urlParams.get('video_id');
        
        if (videoId) {
            document.getElementById('videoId').value = videoId;
            playVideo(videoId);
        }

        async function playFromInput() {
            const videoId = document.getElementById('videoId').value.trim();
            if (videoId) {
                // URL'yi g√ºncelle
                window.history.replaceState({}, '', `?video_id=${videoId}`);
                playVideo(videoId);
            }
        }

        async function playVideo(videoId) {
            const videoPlayer = document.getElementById('videoPlayer');
            const urlDisplay = document.getElementById('urlDisplay');
            
            videoPlayer.src = '';
            urlDisplay.innerHTML = 'üîÑ M3U8 URL alƒ±nƒ±yor...';
            
            try {
                // Proxy √ºzerinden M3U8 al
                const m3u8Url = await getM3U8Url(videoId);
                
                if (m3u8Url) {
                    videoPlayer.src = m3u8Url;
                    videoPlayer.load();
                    urlDisplay.innerHTML = `‚úÖ M3U8 URL: ${m3u8Url}`;
                } else {
                    urlDisplay.innerHTML = '‚ùå M3U8 URL bulunamadƒ±';
                }
                
            } catch (error) {
                urlDisplay.innerHTML = `‚ùå Hata: ${error.message}`;
            }
        }

        async function getM3U8Url(videoId) {
            // √úcretsiz CORS proxy kullan
            const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
            const targetUrl = `https://www.youtube.com/watch?v=${videoId}`;
            
            const response = await fetch(proxyUrl + targetUrl, {
                headers: {
                    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                }
            });
            
            const html = await response.text();
            
            // hlsManifestUrl'yi ara
            const regex = /"hlsManifestUrl":"([^"]+)"/;
            const match = html.match(regex);
            
            if (match && match[1]) {
                return match[1].replace(/\\u0026/g, '&');
            }
            
            return null;
        }
    </script>
</body>
</html>
